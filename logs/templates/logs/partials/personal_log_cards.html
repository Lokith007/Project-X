{% load static %}
{% load custom_filter %}

{% for log in logs %}
<div class="bg-[#12161d] border border-[#21262d] rounded-lg p-4 hover:border-[#30363d] transition-all duration-200">
    
    <!-- Header with timestamp -->
    <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-2 text-xs text-gray-500 font-mono">
            <i class="fa fa-clock-o text-[10px]"></i>
            <span>{{ log.timestamp|timesince }} ago</span>
        </div>
        {% if log.user == request.user.info %}
        <button class="delete-log-btn text-gray-500 hover:text-red-400 transition-colors p-1" data-log-id="{{ log.id }}">
            <i class="fa fa-trash text-xs"></i>
        </button>
        {% endif %}
    </div>

    <!-- Log content -->
    <div class="space-y-3">
        <div class="flex items-start gap-2">
            <span class="text-green-400 mt-0.5 text-sm flex-shrink-0">&gt;_</span>
            <p class="text-gray-200 text-sm leading-relaxed font-mono flex-1">{{ log.content }}</p>
        </div>

        <!-- Snapshot image -->
        {% if log.snap_shot %}
        <div class="mt-3">
            <img src="{{ log.snap_shot.url }}" 
                 alt="Log snapshot" 
                 onclick="previewImage('{{ log.snap_shot.url }}')"
                 class="w-48 h-48 object-cover rounded-md border border-[#21262d] cursor-pointer hover:opacity-90 transition-opacity duration-200 shadow-md">
        </div>
        {% endif %}

        <!-- Code snippet -->
        {% if log.code_snippet %}
        <div class="relative bg-[#0a0e14] border border-[#21262d] rounded-md p-3 mt-3">
            <div class="flex items-center justify-between mb-2">
                <span class="text-[10px] text-gray-500 font-mono uppercase tracking-wider">Code</span>
                <button onclick="copySnippet('{{ log.sig }}')" 
                        class="text-gray-500 hover:text-green-400 transition-colors">
                    <i class="fa fa-copy text-xs"></i>
                </button>
            </div>
            <pre id="code-snippet-{{ log.sig }}" class="text-green-300 font-mono text-xs overflow-x-auto overflow-y-auto whitespace-pre-wrap break-words max-h-80"><code>{{ log.code_snippet }}</code></pre>
        </div>
        {% endif %}

        <!-- Link -->
        {% if log.link %}
        <a href="{{ log.link }}" 
           target="_blank" 
           class="flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors text-xs font-mono mt-2">
            <i class="fa fa-link text-[10px]"></i>
            <span class="truncate">{{ log.link }}</span>
            <i class="fa fa-external-link text-[8px]"></i>
        </a>
        {% endif %}
    </div>

    <!-- Footer stats -->
    <div class="flex items-center gap-4 mt-4 pt-3 border-t border-[#21262d]">
        <div class="flex items-center gap-1.5 text-xs text-gray-500">
            <i class="fa fa-code-branch text-xs"></i>
            <span class="font-mono">{{ log.clone_count }}</span>
        </div>
    </div>

</div>
{% endfor %}

{% if not logs %}
<div class="text-center py-12 text-gray-500">
    <i class="fa fa-inbox text-3xl mb-3 opacity-30"></i>
    <p class="text-sm">No logs yet</p>
</div>
{% endif %}